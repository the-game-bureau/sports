<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kat's Football Schedules 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-weight: 400;
            line-height: 1.4;
            color: #000;
            background-color: #fff;
            font-size: 16px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            margin-bottom: 60px;
            border-bottom: 2px solid #000;
            padding-bottom: 20px;
        }

        h1 {
            font-size: 48px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 18px;
            color: #666;
            font-weight: 300;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-left: 4px solid #dc3545;
            margin-bottom: 20px;
        }

        .fallback-notice {
            background-color: #fff3cd;
            color: #856404;
            padding: 20px;
            border-left: 4px solid #ffc107;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin-top: 40px;
        }

        .game-card {
            border: 1px solid #e0e0e0;
            padding: 24px;
            background-color: #fff;
            transition: all 0.2s ease;
        }

        .game-card:hover {
            border-color: #000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .game-date {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #666;
            margin-bottom: 8px;
        }

        .game-time {
            font-size: 12px;
            color: #999;
            margin-bottom: 16px;
        }

        .matchup {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.2;
        }

        .team-highlight {
            background-color: #000;
            color: #fff;
            padding: 2px 6px;
            font-weight: 700;
        }

        .game-details {
            font-size: 14px;
            color: #666;
            margin-top: 12px;
        }

        .league-badge {
            display: inline-block;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: 2px;
            margin-bottom: 12px;
        }

        .nfl {
            background-color: #013369;
            color: #fff;
        }

        .college {
            background-color: #8B0000;
            color: #fff;
        }

        .no-games {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 16px;
            }

            h1 {
                font-size: 36px;
            }

            .games-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .game-card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Kat's Football Schedules 2025</h1>
            <p class="subtitle">by Kevin Kolb</p>
        </header>

        <div id="loading" class="loading">
            Loading schedules...
        </div>

        <div id="error-message" class="error" style="display: none;"></div>
        
        <div id="fallback-notice" class="fallback-notice" style="display: none;">
            Unable to load XML data from external sources. Displaying sample schedule data. To use live data, please ensure the XML URLs are accessible.
        </div>

        <div id="games-container" class="games-grid"></div>
    </div>

    <script>
        // Target teams (case insensitive matching)
        const TARGET_TEAMS = [
            { name: 'saints', variations: ['saints', 'new orleans saints'] },
            { name: 'florida gators', variations: ['florida', 'florida gators', 'gators'] },
            { name: 'tulane green wave', variations: ['tulane', 'tulane green wave', 'green wave'] },
            { name: 'lsu tigers', variations: ['lsu', 'lsu tigers', 'tigers', 'louisiana state'] }
        ];

        // Sample data for demonstration (fallback)
        const SAMPLE_GAMES = [
            {
                date: '2025-09-06',
                time: '12:00 PM',
                homeTeam: 'LSU Tigers',
                awayTeam: 'USC Trojans',
                location: 'Tiger Stadium, Baton Rouge, LA',
                league: 'COLLEGE'
            },
            {
                date: '2025-09-07',
                time: '1:00 PM',
                homeTeam: 'New Orleans Saints',
                awayTeam: 'Carolina Panthers',
                location: 'Caesars Superdome, New Orleans, LA',
                league: 'NFL'
            },
            {
                date: '2025-09-13',
                time: '7:00 PM',
                homeTeam: 'Florida Gators',
                awayTeam: 'Tennessee Volunteers',
                location: 'Ben Hill Griffin Stadium, Gainesville, FL',
                league: 'COLLEGE'
            },
            {
                date: '2025-09-14',
                time: '4:25 PM',
                homeTeam: 'Atlanta Falcons',
                awayTeam: 'New Orleans Saints',
                location: 'Mercedes-Benz Stadium, Atlanta, GA',
                league: 'NFL'
            },
            {
                date: '2025-09-20',
                time: '6:30 PM',
                homeTeam: 'Tulane Green Wave',
                awayTeam: 'Navy Midshipmen',
                location: 'Yulman Stadium, New Orleans, LA',
                league: 'COLLEGE'
            },
            {
                date: '2025-09-21',
                time: '1:00 PM',
                homeTeam: 'New Orleans Saints',
                awayTeam: 'Green Bay Packers',
                location: 'Caesars Superdome, New Orleans, LA',
                league: 'NFL'
            },
            {
                date: '2025-09-27',
                time: '12:00 PM',
                homeTeam: 'Kentucky Wildcats',
                awayTeam: 'Florida Gators',
                location: 'Kroger Field, Lexington, KY',
                league: 'COLLEGE'
            },
            {
                date: '2025-10-04',
                time: '7:00 PM',
                homeTeam: 'LSU Tigers',
                awayTeam: 'South Alabama Jaguars',
                location: 'Tiger Stadium, Baton Rouge, LA',
                league: 'COLLEGE'
            }
        ];

        async function fetchWithMultipleMethods(url) {
            const methods = [
                // Direct fetch
                () => fetch(url),
                // CORS proxy 1
                () => fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`),
                // CORS proxy 2
                () => fetch(`https://corsproxy.io/?${encodeURIComponent(url)}`),
                // CORS proxy 3
                () => fetch(`https://cors-anywhere.herokuapp.com/${url}`)
            ];

            for (let i = 0; i < methods.length; i++) {
                try {
                    console.log(`Trying fetch method ${i + 1} for ${url}`);
                    const response = await methods[i]();
                    if (response.ok) {
                        const text = await response.text();
                        console.log(`Success with method ${i + 1}`);
                        return text;
                    }
                } catch (error) {
                    console.log(`Method ${i + 1} failed:`, error.message);
                }
            }
            throw new Error(`All fetch methods failed for ${url}`);
        }

        function isTargetTeam(teamName) {
            if (!teamName) return null;
            const lowerTeamName = teamName.toLowerCase();
            
            for (const target of TARGET_TEAMS) {
                if (target.variations.some(variation => 
                    lowerTeamName.includes(variation.toLowerCase()) || 
                    variation.toLowerCase().includes(lowerTeamName)
                )) {
                    return target.name;
                }
            }
            return null;
        }

        function parseXMLGame(gameElement, league) {
            // Try multiple ways to get the data
            const date = gameElement.getAttribute('date') || 
                        gameElement.querySelector('date')?.textContent || 
                        gameElement.querySelector('Date')?.textContent;
            
            const time = gameElement.getAttribute('time') || 
                        gameElement.querySelector('time')?.textContent ||
                        gameElement.querySelector('Time')?.textContent;
            
            const homeTeam = gameElement.getAttribute('home') || 
                            gameElement.getAttribute('homeTeam') ||
                            gameElement.querySelector('home')?.textContent ||
                            gameElement.querySelector('homeTeam')?.textContent ||
                            gameElement.querySelector('Home')?.textContent;
            
            const awayTeam = gameElement.getAttribute('away') || 
                            gameElement.getAttribute('awayTeam') ||
                            gameElement.querySelector('away')?.textContent ||
                            gameElement.querySelector('awayTeam')?.textContent ||
                            gameElement.querySelector('Away')?.textContent;
            
            const location = gameElement.getAttribute('location') || 
                            gameElement.querySelector('location')?.textContent ||
                            gameElement.querySelector('Location')?.textContent;

            const homeTargetTeam = isTargetTeam(homeTeam);
            const awayTargetTeam = isTargetTeam(awayTeam);

            if (!homeTargetTeam && !awayTargetTeam) {
                return null;
            }

            return createGameObject(date, time, homeTeam, awayTeam, location, league);
        }

        function createGameObject(date, time, homeTeam, awayTeam, location, league) {
            let dateObj = new Date('2099-12-31');
            if (date && date !== 'TBD') {
                try {
                    const parsedDate = new Date(date);
                    if (!isNaN(parsedDate.getTime())) {
                        dateObj = parsedDate;
                    }
                } catch (e) {
                    console.warn('Could not parse date:', date);
                }
            }

            const homeTargetTeam = isTargetTeam(homeTeam);
            const awayTargetTeam = isTargetTeam(awayTeam);

            return {
                date: date || 'TBD',
                time: time || '',
                homeTeam: homeTeam || 'TBD',
                awayTeam: awayTeam || 'TBD',
                location: location || '',
                league: league,
                targetTeam: homeTargetTeam || awayTargetTeam,
                dateObj: dateObj
            };
        }

        function formatDate(dateStr) {
            if (!dateStr || dateStr === 'TBD') return 'TBD';
            try {
                const date = new Date(dateStr);
                if (isNaN(date.getTime())) return dateStr;
                return date.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch (e) {
                return dateStr;
            }
        }

        function formatTime(timeStr) {
            if (!timeStr) return '';
            try {
                // Handle various time formats
                if (timeStr.includes('PM') || timeStr.includes('AM')) {
                    return timeStr; // Already formatted
                }
                const time = new Date(`2000-01-01 ${timeStr}`);
                return time.toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit'
                });
            } catch (e) {
                return timeStr;
            }
        }

        function createGameCard(game) {
            const homeHighlight = isTargetTeam(game.homeTeam) ? 'team-highlight' : '';
            const awayHighlight = isTargetTeam(game.awayTeam) ? 'team-highlight' : '';

            return `
                <div class="game-card">
                    <div class="league-badge ${game.league.toLowerCase()}">${game.league}</div>
                    <div class="game-date">${formatDate(game.date)}</div>
                    ${game.time ? `<div class="game-time">${formatTime(game.time)}</div>` : ''}
                    <div class="matchup">
                        <span class="${awayHighlight}">${game.awayTeam}</span>
                        <br>@<br>
                        <span class="${homeHighlight}">${game.homeTeam}</span>
                    </div>
                    ${game.location ? `<div class="game-details">${game.location}</div>` : ''}
                </div>
            `;
        }

        async function loadSchedules() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error-message');
            const fallbackEl = document.getElementById('fallback-notice');
            const containerEl = document.getElementById('games-container');

            try {
                loadingEl.style.display = 'block';
                errorEl.style.display = 'none';
                fallbackEl.style.display = 'none';

                const games = [];

                // Try to load XML data
                try {
                    const collegeXmlText = await fetchWithMultipleMethods('https://kevinkolb.github.io/horsesmouthsportsdata/games/collegegames.xml');
                    const nflXmlText = await fetchWithMultipleMethods('https://kevinkolb.github.io/horsesmouthsportsdata/games/nflgames.xml');

                    const parser = new DOMParser();
                    const collegeDoc = parser.parseFromString(collegeXmlText, 'text/xml');
                    const nflDoc = parser.parseFromString(nflXmlText, 'text/xml');

                    // Parse college games
                    let collegeGames = collegeDoc.querySelectorAll('game, Game');
                    if (collegeGames.length === 0) {
                        collegeGames = Array.from(collegeDoc.documentElement.children);
                    }
                    
                    collegeGames.forEach(gameEl => {
                        const game = parseXMLGame(gameEl, 'COLLEGE');
                        if (game) games.push(game);
                    });

                    // Parse NFL games
                    let nflGames = nflDoc.querySelectorAll('game, Game');
                    if (nflGames.length === 0) {
                        nflGames = Array.from(nflDoc.documentElement.children);
                    }
                    
                    nflGames.forEach(gameEl => {
                        const game = parseXMLGame(gameEl, 'NFL');
                        if (game) games.push(game);
                    });

                    console.log(`Loaded ${games.length} games from XML data`);

                } catch (xmlError) {
                    console.log('XML loading failed, using sample data:', xmlError.message);
                    
                    // Use sample data as fallback
                    SAMPLE_GAMES.forEach(sampleGame => {
                        const game = createGameObject(
                            sampleGame.date,
                            sampleGame.time,
                            sampleGame.homeTeam,
                            sampleGame.awayTeam,
                            sampleGame.location,
                            sampleGame.league
                        );
                        if (game && (isTargetTeam(game.homeTeam) || isTargetTeam(game.awayTeam))) {
                            games.push(game);
                        }
                    });

                    fallbackEl.style.display = 'block';
                }

                // Sort games chronologically
                games.sort((a, b) => {
                    if (!a.dateObj || !b.dateObj) return 0;
                    return a.dateObj.getTime() - b.dateObj.getTime();
                });

                loadingEl.style.display = 'none';

                if (games.length === 0) {
                    containerEl.innerHTML = '<div class="no-games">No games found for the selected teams.</div>';
                    return;
                }

                containerEl.innerHTML = games.map(createGameCard).join('');

            } catch (error) {
                console.error('Error loading schedules:', error);
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                errorEl.textContent = `Error loading schedules: ${error.message}`;
            }
        }

        // Load schedules when page loads
        document.addEventListener('DOMContentLoaded', loadSchedules);
    </script>
</body>
</html>